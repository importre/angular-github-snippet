// angular-github-snippet v0.1.0 (2014.03.09)
// Copyright (c) 2014, Jaewe Heo. All rights reserved.
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.
var ghsnip=angular.module("ghsnip",["hljs","base64"]);ghsnip.directive("ghsnip",["$http","$base64","$compile",function(a,b,c){return this.getCodeHtml=function(a,c){var d,e,f=a.content,g=f.split("\n");for(d=0;d<g.length;d++)g[d]=b.decode(g[d]);if(g=g.join("").split("\n"),0===c.length)for(d=0;d<g.length;d++)c[d]=d+1;var h=[],i=0,j=-1;for(d=0;d<c.length&&d<g.length;d++)e=c[d],j>=0&&e-j!=1&&(h[i++]=" \n	...omitted...\n"),h[i++]=g[e-1],j=e;console.log(a);var k="<div class='code'><h3><a href='"+a.html_url+"' target='_blank'>"+a.path+"</a></h3><hr/><div hljs>"+h.join(" \n")+"</div></div>";return k},this.loadSnippet=function(b,d,e){if(e.hasOwnProperty("code")){var f="<div>loading...</div>";d.html(f),a({method:"GET",url:e.code}).success(function(a){var f=null;e.hasOwnProperty("lines")&&(f=e.lines),f=b.parseLines(f);var g=this.getCodeHtml(a,f),h=c(g)(b);d.replaceWith(h)}).error(function(a){d.html(a.message)})}},{restrict:"E",controller:"ghsnipCtrl",template:'<div ng-bind-html="code"></div>',compile:function(){return function(a,b,c){this.loadSnippet(a,b,c)}}}}]),ghsnip.controller("ghsnipCtrl",["$scope",function(a){a.parseLines=function(a){var b,c,d,e,f,g=0,h=[],i=function(a){h.indexOf(a)<0&&(h[g++]=a)};if(!a||"string"!=typeof a)return h;for(a=a.split(","),b=0;b<a.length;b++)if(f=a[b],f.indexOf(":")>0){if(f=f.split(":"),2==f.length&&(d=parseInt(f[0]),e=parseInt(f[1]),d&&e&&d>0&&e>0))for(d>e&&(e=[d,d=e][0]),c=d;e>=c;c++)i(c)}else f=parseInt(f),f&&i(f);return h.sort(function(a,b){return a-b}),h}}]);